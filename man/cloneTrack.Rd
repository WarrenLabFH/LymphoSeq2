% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cloneTrack.R
\name{cloneTrack}
\alias{cloneTrack}
\title{Clone tracking plot}
\usage{
cloneTrack(
  study_table,
  sample_list = NULL,
  sequence_track = NULL,
  unassigned = TRUE
)
}
\arguments{
\item{study_table}{A tibble of productive amino acid sequences 
generated by LymphoSeq function productiveSeq where the aggregate parameter 
was set to "junction_aa"}

\item{sequence_track}{An optional character vector of one or more amino acid 
sequences to track. If set to NULL (default), will pull all junction_aa sequences
from the sequence matrix.}

\item{sample_map}{A character vector of one or more repertoire_ids to track.
If set to NULL (default), all repertoire_ids in the sequence matrix will be tracked.}
}
\value{
Returns a line plot showing the amino acid frequencies across 
multiple samples in the sequence matrix where each line represents one 
unique sequence.
}
\description{
Creates line plot tracking amino acid frequencies across multiple samples
}
\details{
The plot is made using the package ggplot2 and can be reformatted
using ggplot2 functions.  See examples below.
}
\examples{
file.path <- system.file("extdata", "TCRB_sequencing", package = "LymphoSeq")

study_table <- readImmunoSeq(path = file.path)

productive_aa <- productiveSeq(study_table = study_table, aggregate = "junction_aa")

top_freq <- topFreq(productive_table = productive_aa, percent = 0.1)

sequence_matrix <- seqMatrix(productive_table = productive_aa, sequences = top.freq$junction_aa)

# Track clones without mapping or tracking specific sequences
cloneTrack(sequence_matrix = sequence_matrix)

# Track top 20 clones mapping to the CD4 and CD8 samples
cloneTrack(sequence_matrix = sequence_matrix, productive_table =  productive_aa, 
   map = c("TRB_CD4_949", "TRB_CD8_949"), label = c("CD4", "CD8"), 
   track = top_freq$junction_aa[1:20], unassigned = TRUE) 

# Track the top 10 clones from top.freq
cloneTrack(sequence_matrix = sequence_matrix, productive_table = productive_aa, 
   track = top_freq$junction_aa[1:10], unassigned = FALSE) 

# Track clones mapping to the CD4 and CD8 samples while ignoring all others
cloneTrack(sequence_matrix = sequence_matrix, productive_table = productive_aa, 
   map = c("TRB_CD4_949", "TRB_CD8_949"), label = c("CD4", "CD8"), 
   unassigned = FALSE) 

# Track clones mapping to the CD4 and CD8 samples and track 2 specific sequences
cloneTrack(sequence_matrix = sequence_matrix, productive_table = productive_aa, 
   map = c("TRB_CD4_949", "TRB_CD8_949"), label = c("CD4", "CD8"), 
   track = c("CASSPPTGERDTQYF", "CASSQDRTGQYGYTF"), unassigned = FALSE)

# Reorder the x axis, change the axis labels, convert to log scale, and add title
x.limits <- c("TRB_Unsorted_0", "TRB_Unsorted_32", 
   "TRB_Unsorted_83", "TRB_Unsorted_949", "TRB_Unsorted_1320")

sequence.matrix <- sequence.matrix[ ,c("junction_aa", x.limits)]
   
clone.track <- cloneTrack(sequence.matrix = sequence.matrix, 
   productive.aa = productive.aa, track = top.freq$junction_aa[1:10], unassigned = FALSE) 

x.labels <- c("Day 0", "Day 32", "Day 83", "Day 949", "Day 1320")

clone.track + 
   ggplot2::scale_x_discrete(expand = c(0,0), labels = x.labels) + 
   ggplot2::scale_y_log10() + ggplot2::annotation_logticks(sides = "l") + 
   ggplot2::ggtitle("Figure Title")
}
\seealso{
An excellent resource for examples on how to reformat a ggplot can 
be found in the R Graphics Cookbook online (\url{http://www.cookbook-r.com/Graphs/}).
}
